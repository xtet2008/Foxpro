* -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
*  文件名: MAIN.PRG(主文件) <-- 本文件由 UnFoxAll 创建
* -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-


 _SCREEN.CAPTION = 'International Trader v9.0.0'
 SET SYSFORMATS OFF
 DECLARE INTEGER GetPrivateProfileString IN Win32API AS GetPrivStr STRING , STRING ,  ;
      STRING , STRING @ , INTEGER , STRING 
 DECLARE INTEGER WritePrivateProfileString IN Win32API AS WritePrivStr STRING , STRING ,  ;
      STRING , STRING 
 DECLARE INTEGER RegOpenKeyEx IN Win32API INTEGER , STRING @ , INTEGER , INTEGER ,  ;
      INTEGER @
 DECLARE INTEGER RegQueryValueEx IN Win32API INTEGER , STRING , INTEGER , INTEGER @ ,  ;
      STRING @ , INTEGER @
 DECLARE INTEGER RegCloseKey IN Win32API INTEGER 
 DECLARE INTEGER GetProfileString IN Win32API AS GetProStr STRING , STRING , STRING ,  ;
      STRING @ , INTEGER 
 CLEAR 
 DEACTIVATE WINDOW Project Manager
 IF SET('TALK') = 'ON'
    SET TALK OFF
    PUBLIC GCOLDTALK
    GCOLDTALK = 'ON'
 ELSE 
    PUBLIC GCOLDTALK
    GCOLDTALK = 'OFF'
 ENDIF 
 SET EXCLUSIVE OFF
 SET COLLATE TO 'MACHINE'
 SET  ???SET[25] TO 0
 SET SYSFORMATS OFF
 _SCREEN.WINDOWSTATE = 2
 _SCREEN.CAPTION = ''
 _SCREEN.ICON = 'ITRADER.ICO'
 _SCREEN.CAPTION = 'International Trader v9.0.0'
 IF  .NOT. FILE('\DOS\TREE.INI') .OR.  .NOT. FILE('\DOS\MODE.INI')
    = MESSAGEBOX('Illegal Installation Not Allowed!',304,'WARNING ?')
    RETURN 
 ENDIF 
 IF FILE('INCLUDE\ITRADER.ICO')
    _SCREEN.ICON = 'INCLUDE\ITRADER.ICO'
 ENDIF 
 SET DELETED ON
 IF DISKSPACE() <= 20000000
    = MESSAGEBOX('Please try to delete some redundant files from your hard disk ! Your disk space is ' +  ;
   ALLTRIM(STR(DISKSPACE() / 1048576,9,2)) +  ;
   ' M .',304,'INSUFFICIENT DISK SPACE WILL HAPPEN !')
    IF DISKSPACE() <= 15000000
       = MESSAGEBOX('Insufficient Disk Space ! You should have 15M of disk space at least !',304,'YOU SHOULD STOP NOW !')
       RETURN 
    ENDIF 
 ENDIF 
 PUBLIC GCOLDDIR , GCOLDPATH , GCOLDCLASSLIB , GCOLDESCAPE , SCREEN_KEY , DEF_LANG ,  ;
      DEF_CHINESE , TB_MENU , SYSTOTALPAGE , TKVALUE
 GCOLDESCAPE = SET('ESCAPE')
 GCOLDDIR = FULLPATH(CURDIR())
 GCOLDPATH = SET('PATH')
 GCOLDCLASSLIB = SET('CLASSLIB')
 SYSTOTALPAGE = 1
 TLOGIC = .F.
 IF FILE('ITOOLBAR.DBF')
    IF  .NOT. USED('itoolbar')
       USE IN 0 itoolbar
    ENDIF 
    SELECT ITOOLBAR
    GO TOP
    DEF_LANG = ALLTRIM(ITOOLBAR.DEF_LANG)
    IF VERSION(3) = '00' .OR. OS(2) <> 'DBCS'
       DEF_LANG = 'ENG'
    ENDIF 
    USE IN ITOOLBAR
 ENDIF 
 IF SETPATH()
    ID_VALUE = ''
    SYS_COMPANYID = ''
    SYS_WEBACCESS = 'N'
    SYS_INITIAL = 'N'
    SET_DOCUMENT = ''
    SET_FILES = ''
    SET_MYFILES = ''
    SET_PHOTOS = ''
    SET_PUBLIC = ''
    SET_NEWINCL = ''
    SCREEN_KEY = ''
    GLUPDATEADATETIME = .T.
    EAI_PATH = ''
    OUTBOX_PATH = ''
    INBOX_PATH = ''
    SYS_SQLCONNECTION = ''
    SYS_SQLSTATUS = -1
    SYS_SQLUSERNAME = ''
    SYS_SQLDBNAME = ''
    SYS_SQLUSERPASSWORD = ''
    SYS_SQLTYPE = ''
    SYS_PANEL = 'DESKTOP'
    SYS_HIGHLIGHT = RGB(255,255,128)
    SYS_TOOLBAR = 'tstoolbar'
    SYS_COMPANYGROUP = ''
    SET STATUS BAR OFF
    DO FORM COMPANY
    IF  .NOT. USED('DESKTOP')
       USE IN 0 DESKTOP
    ENDIF 
    SELECT DESKTOP
    SET ORDER TO STATION
    SEEK ALLTRIM(ID_VALUE)
    STORE DESKTOP.FSIZE TO FSIZE
    STORE ALLTRIM(DESKTOP.FNAME) TO FNAME
    STORE DESKTOP.FBOLD TO FBOLD
    STORE DESKTOP.FSIZE1 TO FSIZE1
    STORE ALLTRIM(DESKTOP.FNAME1) TO FNAME1
    STORE DESKTOP.FBOLD1 TO FBOLD1
    STORE DESKTOP.FSIZE2 TO FSIZE2
    STORE ALLTRIM(DESKTOP.FNAME2) TO FNAME2
    STORE DESKTOP.FBOLD2 TO FBOLD2
    IF VARTYPE(WEBACCESS) = 'C'
       SYS_WEBACCESS = DESKTOP.WEBACCESS
    ENDIF 
    IF VARTYPE(TOOLBAR) = 'C'
       IF  .NOT. EMPTY(DESKTOP.TOOLBAR)
          SYS_TOOLBAR = ALLTRIM(DESKTOP.TOOLBAR)
       ENDIF 
    ENDIF 
    IF VARTYPE(INITIAL) = 'C'
       SYS_INITIAL = ALLTRIM(DESKTOP.INITIAL)
       IF  .NOT. EMPTY(SYS_INITIAL)
           &SYS_INITIAL.
       ENDIF 
    ENDIF 
    IF VARTYPE(CONTROL_WD) = 'C'
       SET_DOCUMENT = ALLTRIM(DESKTOP.CONTROL_WD)
       SET_FILES = ALLTRIM(DESKTOP.CONTROL_EX)
    ENDIF 
    IF VARTYPE(CONTROL_EA) = 'C'
       EAI_PATH = ALLTRIM(DESKTOP.CONTROL_EA)
    ENDIF 
    IF VARTYPE(INBOX) = 'C'
       INBOX_PATH = ALLTRIM(DESKTOP.INBOX)
    ENDIF 
    IF VARTYPE(OUTBOX) = 'C'
       OUTBOX_PATH = ALLTRIM(DESKTOP.OUTBOX)
    ENDIF 
    IF EMPTY(INBOX_PATH)
       INBOX_PATH = ALLTRIM(DESKTOP.CONTROL_PA) + '\eaidata\inbox\'
    ENDIF 
    IF EMPTY(OUTBOX_PATH)
       OUTBOX_PATH = ALLTRIM(DESKTOP.CONTROL_PA) + '\eaidata\outbox\'
    ENDIF 
    IF VARTYPE(SQL_CONN) = 'C'
       SYS_SQLCONNECTION = ALLTRIM(DESKTOP.SQL_CONN)
    ENDIF 
    IF VARTYPE(SQL_USER) = 'C'
       SYS_SQLUSERNAME = ALLTRIM(DESKTOP.SQL_USER)
    ENDIF 
    IF VARTYPE(SQL_DB) = 'C'
       SYS_SQLDBNAME = ALLTRIM(DESKTOP.SQL_DB)
    ENDIF 
    IF VARTYPE(SQL_PASS) = 'C'
       SYS_SQLUSERPASSWORD = ALLTRIM(DESKTOP.SQL_PASS)
    ENDIF 
    IF VARTYPE(SQL_TYPE) = 'C'
       SYS_SQLTYPE = ALLTRIM(DESKTOP.SQL_TYPE)
    ENDIF 
    IF VARTYPE(CTRL_PANEL) = 'C'
       SYS_PANEL = ALLTRIM(DESKTOP.CTRL_PANEL)
       IF EMPTY(SYS_PANEL)
          SYS_PANEL = 'DESKTOP'
       ENDIF 
    ENDIF 
    IF VARTYPE(NEWINCL) = 'C'
       SET_NEWINCL = ALLTRIM(DESKTOP.NEWINCL)
    ENDIF 
    IF EMPTY(SET_NEWINCL)
       TCHARACTER = ALLTRIM(DESKTOP.CONTROL_PA)
       IF DIRECTORY(SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEW\NEWINCL\')
          SET_NEWINCL = SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEW\NEWINCL\'
       ELSE 
          IF DIRECTORY(SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEW\INCLUDE\')
             SET_NEWINCL = SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEW\INCLUDE\'
          ELSE 
             IF DIRECTORY(SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEWINCL\')
                SET_NEWINCL = SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'NEWINCL\'
             ELSE 
                IF DIRECTORY(SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'INCLUDE\')
                   SET_NEWINCL = SUBSTR(TCHARACTER,1,RAT('\',TCHARACTER,2)) + 'INCLUDE\'
                ELSE 
                   IF DIRECTORY(SET_PUBLIC + 'TEMPDBF\')
                      SET_NEWINCL = SET_PUBLIC + 'TEMPDBF\'
                   ENDIF 
                ENDIF 
             ENDIF 
          ENDIF 
       ENDIF 
       TCHARACTER = ''
    ENDIF 
    IF EMPTY(SET_DOCUMENT)
       SET_DOCUMENT = ALLTRIM(DESKTOP.CONTROL_PA) + 'DOCUMENT\'
    ENDIF 
    IF EMPTY(SET_FILES)
       SET_FILES = ALLTRIM(DESKTOP.CONTROL_PA) + 'FILES\'
    ENDIF 
    IF  .NOT. DIRECTORY(SET_DOCUMENT)
       SET_DOCUMENT = ALLTRIM(DESKTOP.CONTROL_PU)
    ENDIF 
    IF  .NOT. DIRECTORY(SET_FILES)
       SET_FILES = ALLTRIM(DESKTOP.CONTROL_PU)
    ENDIF 
    IF VARTYPE(CONTROL_PH) = 'C'
       SET_PHOTOS = ALLTRIM(DESKTOP.CONTROL_PH)
       IF EMPTY(SET_PHOTOS)
          SET_PHOTOS = ALLTRIM(DESKTOP.CONTROL_PA) + 'PHOTOS\'
       ENDIF 
       IF  .NOT. DIRECTORY(SET_PHOTOS)
          SET_PHOTOS = ALLTRIM(DESKTOP.CONTROL_PA) + 'BITMAPS\'
       ENDIF 
    ENDIF 
    IF  .NOT. FILE(ALLTRIM(DESKTOP.CONTROL_PA) + 'DATA\PARAMETE.DBF')
       = MESSAGEBOX('Please Logon your file server or you failed to startup iTrader database!',304,'INVALID CONTROL PATH!')
       IF SUBSTR(SYS_WEBACCESS,8,1) <> 'Y' AND AT('\\',ALLTRIM(DESKTOP.CONTROL_PA)) = 0
          DO FORM desktop
          USE IN DESKTOP
       ENDIF 
       RETURN 
    ENDIF 
    SET_PATH = 'PROGS,FORMS, LIBS,MENUS,INCLUDE, HELP,CRMINCL,'
    SET_PATH1 =  ;
         ALLTRIM(DESKTOP.CONTROL_PA) + ',' + SET_PATH + ALLTRIM(DESKTOP.CONTROL_PA) +  ;
   'DATA,' + ALLTRIM(DESKTOP.CONTROL_PA) + 'BITMAPS,' +  ;
   ALLTRIM(DESKTOP.CONTROL_PA) + 'SHIPDOC,' + ALLTRIM(DESKTOP.CONTROL_PA) + 'REPORTS,' +  ;
   ALLTRIM(DESKTOP.CONTROL_PA) + 'BACKLOG,' + ALLTRIM(DESKTOP.CONTROL_PA) + 'SYSFILES,' +  ;
   ALLTRIM(DESKTOP.CONTROL_PU) + ',' + ALLTRIM(DESKTOP.CONTROL_PA) +  ;
   'FILES'
    IF  .NOT. EMPTY(EAI_PATH)
       SET_PATH1 = SET_PATH1 + ',' + EAI_PATH
    ENDIF 
    SET_PATH = ALLTRIM(DESKTOP.CONTROL_PA)
    SET_PUBLIC = ALLTRIM(DESKTOP.CONTROL_PU)
    SET  ???SET[FE] TO (GCOLDDIR)
    SET PATH TO (SET_PATH1)
    TRADE_MARK = TRADE_MARK
    IF  .NOT. FILE('MESSAGE.DBF')
       = MESSAGEBOX('You cannot access a valid PUBLIC DIRECTORY!',304,'INVALID PUBLIC DIRECTORY!')
       DO FORM desktop
       RETURN 
    ENDIF 
    USE IN DESKTOP
    IF  .NOT. USED('PARAMETE')
       USE IN 0 PARAMETE
    ENDIF 
    IF PARAMETE.SINGLE
       USE IN PARAMETE
       SET EXCLUSIVE ON
       USE IN 0 PARAMETE
    ELSE 
       USE IN PARAMETE
       SET EXCLUSIVE OFF
       USE IN 0 PARAMETE
    ENDIF 
    SELECT PARAMETE
    LOCATE FOR PARAMETE.COMPANYID = 'PNJ'
    IF PARAMETE.RUN > 15
       RETURN 
    ENDIF 
    SYS_AMEND = .F.
    ERROR_YN = .F.
    USER_NAME = ''
    USERID = ''
    USERDEPART = ''
    DEPARTHEAD = ''
    SECURITY_ID = ''
    SECURITY_ID2 = ''
    SECURITY_ID3 = ''
    SECURITY_ID4 = ''
    SECURITY_ID5 = ''
    SECURITY_ID6 = ''
    SECURITY_ID7 = ''
    SECURITY_ID8 = ''
    SECURITY_ID9 = ''
    SECURITY_ID10 = ''
    SECURITY_IDEXACT = ''
    SYS_T1 = ''
    SYS_T2 = ''
    SYS_T3 = ''
    SYS_T4 = ''
    SYS_T5 = ''
    SYS_T6 = ''
    SYS_CBM20 = 27
    SYS_CBM40 = 56
    SYS_CBM40HC = 68
    SYS_CBM20WT = 18000
    SYS_CBM40WT = 22000
    SYS_CBM40HCWT = 22000
    EML_ACCOUNTNAME = ''
    EML_PASSWORD = ''
    EML_ADDRESS = ''
    EML_REPLY = ''
    EML_POP3 = ''
    EML_SMTP = ''
    PQ_FILENAME = ''
    PQ_FILEPATH = ''
    LCCONDITION = ''
    ID_VALUE2 = ''
    ID_VALUE3 = ''
    ID_VALUE4 = ''
    ID_VALUE5 = ''
    ID_VALUE6 = ''
    ID_VALUE7 = ''
    ID_TEMPVAL = ''
    SYS_DOCTYPE = ''
    SYS_DOCNAME = ''
    SYS_DOCID = 1
    SYS_CUSTOMER_ID = ''
    SYS_SUPPLIER_ID = ''
    SYS_PRODUCT_ID = ''
    SYS_DOCPOSTED = .F.
    GOTO_ID = .F.
    GO_RECNO = 0
    TQUANTITY = 0
    TCHARACTER = ''
    TDATE = DATE()
    TDATETIME = DATETIME()
    TLOGIC = .F.
    SYSDELWARN1 = 'Are you sure to delete this '
    SYSGENWARN1 = 'Are you sure to create this '
    SYSSAVEWARN1 = 'Are you sure to save this '
    SYSDELWARN2 = 'Delete Warning'
    SYSGENWARN2 = 'Create Warning'
    SYSSAVEWARN2 = 'Save Warning'
    SYSNOTFOUND = ' Not Found !'
    SYSFOUND = ' already exists !'
    SYSCHANGE = 'Change Generation Number ...'
    SYSDISP_HEADER = 'Please select a document type !'
    SYSDISP_DOCTYPE = 'Document Type'
    SYSBUTTON_DEL = '\<DELETE'
    SYSBUTTON_DELALL = 'DEL A\<LL'
    SYSBUTTON_SAVE = '\<SAVE'
    SYSBUTTON_MODIFY = '\<MODIFY'
    SYSBUTTON_CREATE = 'CRE\<ATE'
    SYSBUTTON_ADD = '\<ADD'
    SYSBUTTON_OK = '\<YES'
    SYSBUTTON_NO = '\<NO'
    SYSBUTTON_EXIT = 'E\<XIT'
    SYSBUTTON_CANCEL = '\<CANCEL'
    SYSBUTTON_EDIT = '\<EDIT'
    SYSBUTTON_FILTER = '\<FILTER'
    SYSBUTTON_UNFILTER = '\<UNFILTER'
    SYSBUTTON_POST = '\<POST'
    SYSBUTTON_UNPOST = '\<UNPOST'
    SYSBUTTON_GEN = 'AUTO \<GEN'
    SYSBUTTON_UNDO = '\<UNDO'
    SYSBUTTON_DEFAULT = 'DEFAUL\<T'
    SYSBUTTON_PRINT = '\<PRINT'
    SYSBUTTON_VIEW = '\<VIEW'
    SYSBUTTON_REFRESH = '\<REFRESH'
    SYSBUTTON_SELECTALL = 'SELECT AL\<L'
    SYSBUTTON_SELECT = '\<SELECT'
    SYSBUTTON_UNSELECT = '\<UNSELECT'
    SYSBUTTON_STOCK = 'STOC\<K'
    SYSBUTTON_INSERT = '\<INSERT'
    SYSBUTTON_APPEND = '\<APPEND'
    SYSBUTTON_REPLACE = '\<REPLACE'
    SYSBUTTON_GROUP = '\<GROUP'
    SYSBUTTON_UNGROUP = '\<UNGROUP'
    SYSBUTTON_FIND = '\<FIND'
    SYSBUTTON_SEARCH = '\<SEARCH'
    SYSBUTTON_PHOTO = '\<PHOTO'
    MYSIGNATURE = ''
    SYSSEC_CUSTOMER = .T.
    SYSSEC_SUPPLIER = .T.
    SYSSEC_FACTORY = .T.
    SYSSEC_PRICE = .T.
    SYSSEC_COST = .T.
    SYSSEC_FTYPRICE = .T.
    SYSSEC_MARGIN = .T.
    SYSSEC_SELLQTY = .T.
    SYSSEC_BUYQTY = .T.
    SYSSEC_PRODQTY = .T.
    SYSSEC_BUYTOTAL = .T.
    SYSSEC_SELLTOTAL = .T.
    SYSSEC_PRODTOTAL = .T.
    SYSSEC_BOM = .T.
    OUR_CLIENT =  ;
         ' [' + ALLTRIM(SYS_COMPANYID) + ']   ' + ALLTRIM(PARAMETE.COMPANY1) + ' ' +  ;
   ALLTRIM(PARAMETE.COMPANY2)
    _SCREEN.CAPTION = OUR_CLIENT
    BASIC_CURR = PARAMETE.BASIC_CURR
    ACCT_CURR = PARAMETE.BASIC_CURR
    USUAL_CURR = PARAMETE.BASIC_CURR
    USUAL_RATE = 1
    ACCT_EXRATE = 1
    AC_VOUCHDATE = DATE()
    AC_PER_DATEFR = DATE()
    AC_PER_DATETO = DATE()
    AC_OPENDATEFR = DATE()
    AC_OPENDATETO = DATE()
    USD_EXCHRATE = 7.8
    EUR_EXCHRATE = 12.2
    RMB_EXCHRATE = 1.08
     ???MEM[3F] = 73
    CLIENT_ID = PARAMETE.COMPANYID
    DATE_TYPE = PARAMETE.DATETYPE
     SET DATE TO &DATE_TYPE.
    DATE_TYPE = PARAMETE.CENTURYON
     set century &date_type.
    PROD_PICT = ''
    SUB_PICT = ''
    SUPP_PICT = ''
    CUST_PICT = ''
    PRICE_PICT = ''
    LOTNO_PICT = ''
    BINNO_PICT = ''
    WT_PICT = '99,999,999.99'
    CBM_PICT = '9,999,999.999'
    MEAS_PICT = '9,999.9'
    COST_PICT = '9,999,999.999'
    RATE_PICT = '999.99999'
    WT_DECIMAL = 2
    CBM_DECIMAL = 3
    MEAS_DECIMAL = 1
    COST_DECIMAL = 3
    QTY_PICT = '999,999,999.99'
    BOMQTY_PICT = '999,999,999.99'
    BOMPRICE_PICT = '999,999,999.99'
    DOLLAR_PIC = '999,999,999.99'
    ITRADER_VERSION = 'International Trader v8.1.0 xp'
    PRICE_DECIMAL = 2
    QTY_DECIMAL = 2
    TOTAL_DECIMAL = 2
    SINGLE_CURR = .F.
    SYS_BOMYN = .F.
    SYS_MODULES = ''
    SYS_ACCESSGRP = ''
    SYS_DEPART = ''
    SYS_DBLUNIT = .F.
    SYS_IDDCODE = '001'
    SYS_COUNTRYCODE = '852'
    AC_DECIMAL = 3
    AC_CONTROL = ''
    SYS_SECRETEKEY = '1234567890.'
    SYS_STOCK_FROM = {}
    SYS_STOCK_TO = {^2099/1/1}
    SYS_DATE_FROM = {}
    SYS_DATE_TO = {^2099/1/1}
    SYS_STOCK_YEAR = ''
    SYS_MYFACTORY = ''
    SYS_MYSTOCK = ''
    DE_LIMIT = ''
    ISBARCODE = .F.
    BMPEDIT = ''
    SEEKREF = .F.
    NOTCOUNTBACK = .F.
    STOCK_YN = ''
    ACCOUNT = ''
    PRODUCTION = ''
    TOTAL_PIC = ''
    DESC_FROM = ''
    CURRENT_PERIOD = 1
    STORE ALLTRIM(PARAMETE.BMPEDIT) TO BMPEDIT
    STORE PARAMETE.PROD_PICT TO PROD_PICT
    STORE PARAMETE.SUB_PICT TO SUB_PICT
    STORE PARAMETE.SUPP_PICT TO SUPP_PICT
    STORE PARAMETE.CUST_PICT TO CUST_PICT
    STORE TO PRICE_PICT
    STORE ALLTRIM(PARAMETE.QTY_PICT) TO QTY_PICT
    STORE ALLTRIM(PARAMETE.TOTAL_PIC) TO TOTAL_PIC
    STORE PARAMETE.STOCK TO STOCK_YN
    STORE PARAMETE.ACCOUNT TO ACCOUNT
    STORE PARAMETE.PRODUCTION TO PRODUCTION
    STORE PARAMETE.DELIMIT TO DE_LIMIT
    STORE PARAMETE.ISBARCODE TO ISBARCODE
    STORE PARAMETE.SEEKREF TO SEEKREF
    STORE PARAMETE.DESC_FROM TO DESC_FROM
    STORE PARAMETE.YN1 TO SYS_BOMYN
    STORE PARAMETE.STOCK_FROM TO SYS_STOCK_FROM
    STORE PARAMETE.STOCK_TO TO SYS_STOCK_TO
    STORE PARAMETE.STOCK_YEAR TO SYS_STOCK_YEAR
    STORE PARAMETE.MYFACTORY TO SYS_MYFACTORY
    IF VARTYPE(MYSTOCK) = 'C'
       STORE PARAMETE.MYSTOCK TO SYS_MYSTOCK
    ENDIF 
    IF EMPTY(SYS_STOCK_TO)
       SYS_STOCK_TO = {^2099/1/1}
    ENDIF 
    SET DECIMALS TO PARAMETE.DECIALPLAC
    STORE ALLTRIM(PARAMETE.COMPANY1) TO SYS_COMPANY1
    STORE ALLTRIM(PARAMETE.COMPANY2) TO SYS_COMPANY2
    STORE ALLTRIM(PARAMETE.ADDRESS1) TO SYS_ADDRESS1
    STORE ALLTRIM(PARAMETE.ADDRESS2) TO SYS_ADDRESS2
    STORE ALLTRIM(PARAMETE.ADDRESS3) TO SYS_ADDRESS3
    STORE ALLTRIM(PARAMETE.ADDRESS4) TO SYS_ADDRESS4
    STORE ALLTRIM(PARAMETE.PHONE) TO SYS_PHONE
    STORE ALLTRIM(PARAMETE.FAX) TO SYS_FAX
    STORE ALLTRIM(PARAMETE.TELEX) TO SYS_TELEX
    STORE ALLTRIM(PARAMETE.CABLE) TO SYS_EMAIL
    STORE ALLTRIM(PARAMETE.REGISTERNO) TO SYS_BRNO
    STORE ALLTRIM(PARAMETE.HOMEPAGE) TO SYS_HOMEPAGE
    STORE ALLTRIM(PARAMETE.COUNTRY) TO SYS_COUNTRY
    STORE ALLTRIM(PARAMETE.CITY) TO SYS_CITY
    STORE ALLTRIM(PARAMETE.REGION) TO SYS_REGION
    STORE ALLTRIM(PARAMETE.POSTAL_COD) TO SYS_POSTALCODE
    STORE ALLTRIM(PARAMETE.MULTI_LANG) TO DEF_CHINESE
    IF 
       PRICE_PICT = '999,999,999.99'
    ENDIF 
    IF EMPTY(QTY_PICT)
       QTY_PICT = '999,999,999.99'
    ENDIF 
    IF EMPTY(TOTAL_PIC)
       TOTAL_PIC = '999,999,999.99'
    ENDIF 
    PRICE_DECIMAL = 2
    QTY_DECIMAL = 2
    TOTAL_DECIMAL = 2
    IF AT('.') = 0
       PRICE_DECIMAL = 0
    ELSE 
       PRICE_DECIMAL = LEN() - AT('.')
    ENDIF 
    IF AT('.',ALLTRIM(QTY_PICT)) = 0
       QTY_DECIMAL = 0
    ELSE 
       QTY_DECIMAL = LEN(ALLTRIM(QTY_PICT)) - AT('.',ALLTRIM(QTY_PICT))
    ENDIF 
    IF AT('.',ALLTRIM(TOTAL_PIC)) = 0
       TOTAL_DECIMAL = 0
    ELSE 
       TOTAL_DECIMAL = LEN(ALLTRIM(TOTAL_PIC)) - AT('.',ALLTRIM(TOTAL_PIC))
    ENDIF 
    LOCATE FOR PARAMETE.COMPANYID = 'TAB'
    IF  .NOT. EOF('PARAMETE')
       EML_ACCOUNTNAME = ALLTRIM(PARAMETE.PHONE)
       EML_PASSWORD = ALLTRIM(PARAMETE.FAX)
       EML_ADDRESS = ALLTRIM(PARAMETE.CABLE)
       EML_REPLY = ALLTRIM(PARAMETE.TELEX)
       EML_POP3 = ALLTRIM(PARAMETE.REGION)
       EML_SMTP = ALLTRIM(PARAMETE.POSTAL_COD)
       IF EMPTY(EML_REPLY)
          EML_REPLY = EML_ADDRESS
       ENDIF 
       IF EMPTY(EML_ADDRESS)
          EML_ADDRESS = EML_REPLY
       ENDIF 
       IF VAL(ALLTRIM(PARAMETE.PROD_PICT)) > 0
          SYS_CBM20 = VAL(ALLTRIM(PARAMETE.PROD_PICT))
       ENDIF 
       IF VAL(ALLTRIM(PARAMETE.CUST_PICT)) > 0
          SYS_CBM40 = VAL(ALLTRIM(PARAMETE.CUST_PICT))
       ENDIF 
       IF VAL(ALLTRIM(PARAMETE.SUPP_PICT)) > 0
          SYS_CBM40HC = VAL(ALLTRIM(PARAMETE.SUPP_PICT))
       ENDIF 
       IF VAL(ALLTRIM(PARAMETE.SUB_PICT)) > 0
          SYS_CBM20WT = VAL(ALLTRIM(PARAMETE.SUB_PICT))
       ENDIF 
       IF VAL() > 0
          SYS_CBM40WT = VAL()
       ENDIF 
       IF VAL(ALLTRIM(PARAMETE.QTY_PICT)) > 0
          SYS_CBM40HCWT = VAL(ALLTRIM(PARAMETE.QTY_PICT))
       ENDIF 
    ENDIF 
    LOCATE FOR PARAMETE.COMPANYID = 'FLA'
    STORE PARAMETE.HOMEPAGE TO SYS_PARAMETE
    STORE PARAMETE.YN1 TO SYS_DBLUNIT
    STORE PARAMETE.SEEKREF TO NOCOUNTBACK
    STORE PARAMETE.CREDIT1 TO SYS_MODULES
    STORE ALLTRIM(PARAMETE.PROD_PICT) TO LOTNO_PICT
    STORE ALLTRIM(PARAMETE.SUB_PICT) TO BINNO_PICT
    IF EMPTY(SYS_COMPANYGROUP)
       STORE ALLTRIM(PARAMETE.COMPANY1) TO SYS_COMPANYGROUP
    ENDIF 
    STORE ALLTRIM(PARAMETE.COMPANY1) TO SYS_CCOMPANY1
    STORE ALLTRIM(PARAMETE.COMPANY2) TO SYS_CCOMPANY2
    STORE ALLTRIM(PARAMETE.ADDRESS1) TO SYS_CADDRESS1
    STORE ALLTRIM(PARAMETE.ADDRESS2) TO SYS_CADDRESS2
    STORE ALLTRIM(PARAMETE.ADDRESS3) TO SYS_CADDRESS3
    STORE ALLTRIM(PARAMETE.ADDRESS4) TO SYS_CADDRESS4
    IF 
       STORE PARAMETE.PRICE_PICT TO SYS_SECRETEKEY
    ENDIF 
    STORE ALLTRIM(PARAMETE.PHONE) TO SYS_COUNTRYCODE
    IF  .NOT. EMPTY(PARAMETE.FAX)
       STORE ALLTRIM(PARAMETE.FAX) TO SYS_IDDCODE
    ENDIF 
    IF EMPTY(LOTNO_PICT)
       LOTNO_PICT = '!!!!!!!!!!!!!!!!!!!!'
    ENDIF 
    IF EMPTY(BINNO_PICT)
       BINNO = '!!!!!!!!!!'
    ENDIF 
    IF  .NOT. EMPTY(PARAMETE.BASIC_CURR)
       STORE PARAMETE.BASIC_CURR TO USUAL_CURR
    ENDIF 
    STORE ALLTRIM(PARAMETE.DESC_FROM) TO SYS_DEPART
    IF  .NOT. EMPTY(PARAMETE.BMPEDIT)
       IF  .NOT. FILE(ALLTRIM(PARAMETE.BMPEDIT))
          = MESSAGEBOX('Please ask iTRADER for help!',304,'WARNING ?')
          RETURN 
       ENDIF 
    ENDIF 
    STORE PARAMETE.STOCK_FROM TO SYS_DATE_FROM
    STORE PARAMETE.STOCK_TO TO SYS_DATE_TO
    IF EMPTY(SYS_DATE_FROM)
       SYS_DATE_FROM = DATE() - 365
    ENDIF 
    IF EMPTY(SYS_DATE_TO)
       SYS_DATE_TO = {^2099/1/1}
    ENDIF 
    LOCATE FOR PARAMETE.COMPANYID = 'BOM'
    STORE TO BOMPRICE_PICT
    STORE ALLTRIM(PARAMETE.QTY_PICT) TO BOMQTY_PICT
    IF EMPTY(BOMPRICE_PICT)
       BOMPRICE_PICT = '999,999,999.99'
    ENDIF 
    IF EMPTY(BOMQTY_PICT)
       BOMQTY_PICT = '999,999,999.99'
    ENDIF 
    LOCATE FOR PARAMETE.COMPANYID = 'PIC'
    IF  .NOT. EOF()
       STORE TO WT_PICT
       STORE ALLTRIM(PARAMETE.QTY_PICT) TO CBM_PICT
       STORE ALLTRIM(PARAMETE.TOTAL_PIC) TO MEAS_PICT
       STORE ALLTRIM(PARAMETE.CUST_PICT) TO COST_PICT
       STORE ALLTRIM(PARAMETE.SUPP_PICT) TO RATE_PICT
       IF EMPTY(WT_PICT)
          WT_PICT = '999,999,999.99'
       ENDIF 
       IF EMPTY(CBM_PICT)
          CBM_PICT = '999,999,999.99'
       ENDIF 
       IF EMPTY(MEAS_PICT)
          MEAS_PICT = '999,999,999.99'
       ENDIF 
       IF EMPTY(COST_PICT)
          COST_PICT = '999,999,999.99'
       ENDIF 
       IF EMPTY(RATE_PICT)
          RATE_PICT = '999,999,999.99'
       ENDIF 
       IF AT('.') = 0
          WT_DECIMAL = 0
       ELSE 
          WT_DECIMAL = LEN() - AT('.')
       ENDIF 
       IF AT('.',ALLTRIM(QTY_PICT)) = 0
          CBM_DECIMAL = 0
       ELSE 
          CBM_DECIMAL = LEN(ALLTRIM(QTY_PICT)) - AT('.',ALLTRIM(QTY_PICT))
       ENDIF 
       IF AT('.',ALLTRIM(TOTAL_PIC)) = 0
          MEAS_DECIMAL = 0
       ELSE 
          MEAS_DECIMAL = LEN(ALLTRIM(TOTAL_PIC)) - AT('.',ALLTRIM(TOTAL_PIC))
       ENDIF 
       IF AT('.',ALLTRIM(COST_PICT)) = 0
          COST_DECIMAL = 0
       ELSE 
          COST_DECIMAL = LEN(ALLTRIM(COST_PICT)) - AT('.',ALLTRIM(COST_PICT))
       ENDIF 
    ENDIF 
    USE IN PARAMETE
    IF USED('ACCT_DEF')
       SELECT ACCT_DEF
    ELSE 
       USE IN 0 ACCT_DEF
       SELECT ACCT_DEF
    ENDIF 
    ACCT_CURR = ACCT_DEF.BASIC_CURR
    DOLLAR_PIC = ALLTRIM(ACCT_DEF.DOLLAR_PIC)
    SINGLE_CURR = ACCT_DEF.YN1
    ACCT_ROUNDING = AC_ROUNDIN
    AC_CONTROL = ACCT_DEF.SYSCONTROL
    AC_PER_DATEFR = ACCT_DEF.PER_DATEFR
    AC_PER_DATETO = ACCT_DEF.PER_DATETO
    AC_OPENDATEFR = ACCT_DEF.OPENDATEFR
    AC_OPENDATETO = ACCT_DEF.OPENDATETO
    IF AT('.',ALLTRIM(DOLLAR_PIC)) = 0
       AC_DECIMAL = 1
    ELSE 
       AC_DECIMAL = LEN(ALLTRIM(DOLLAR_PIC)) - AT('.',ALLTRIM(DOLLAR_PIC))
    ENDIF 
    USE IN ACCT_DEF
    IF USED('CURR')
       SELECT CURR
    ELSE 
       USE IN 0 CURR
       SELECT CURR
    ENDIF 
    SET ORDER TO CODE
    SEEK BASIC_CURR
    ACCT_EXRATE = ACCT_RATE
    SEEK USUAL_CURR
    USUAL_RATE = RATE
    SEEK 'USD'
    USD_EXCHRATE = ACCT_RATE
    SEEK 'EUR'
    EUR_EXCHRATE = ACCT_RATE
    SEEK 'RMB'
    RMB_EXCHRATE = ACCT_RATE
    USE IN CURR
    TB_FIRST = ''
    TB_LAST = ''
    TB_PRIOR = ''
    TB_NEXT = ''
    TB_NEW = ''
    TB_SAVE = ''
    TB_EDIT = 'Edit (Ctrl+E)'
    TB_CANCEL = 'Cancel (Ctrl+U)'
    TB_FOLLOWUP = 'Follow-Up (Ctrl+F)'
    TB_DEL = ''
    TB_DUP = ''
    TB_QRY = ''
    TB_FLT = ''
    TB_RECALL = ''
    TB_PRN = ''
    TB_COPY = ''
    TB_EXPORT = 'Excel Exporter'
    TB_PAST = ''
    TB_CUT = ''
    TB_RESTORE = ''
    TB_CAL = ''
    TB_DIRARY = ''
    TB_CLOSE = ''
    TB_MAINSCR = ''
    TB_MENU = ''
    TB_SUB_ITEM = ''
    TB_BAR_CODE = ''
    TB_LOOKUPID = ''
    TB_ITEM_ID = ''
    TB_ITEM_NAME = ''
    TB_STYLE_ID = 'Style No.'
    TB_STYLE_NAME = 'Style Name'
    TB_MATERIAL_ID = 'Material Code'
    TB_MATERIAL_NAME = 'Material Name'
    TB_DESC = ''
    TB_STOCK_ID = ''
    TB_POSTED = 'Posted'
    TB_LOTNO = 'Lot No.'
    TB_BINNO = 'Bin No.'
    TB_CUSTOMERID = 'Customer ID'
    TB_SUPPLIERID = 'Supplier ID'
    TB_FACTORYID = 'Factory ID'
    TB_COMPANY = 'Company Name'
    TB_CUSTOMERNAME = 'Customer Name'
    TB_SUPPLIERNAME = 'Supplier Name'
    TB_FACTORYNAME = 'Factory Name'
    TB_ADDRESS = 'Address'
    TB_ATTN = 'Attn.'
    TB_PHONE = 'Phone'
    TB_FAX = 'Fax'
    TB_EMAIL = 'e-Mail'
    TB_HOMEPAGE = 'Home Page'
    TB_TRADETERM = 'Trade Term'
    TB_PAYMENTTERM = 'Payment Term'
    TB_SHIPTO = 'Ship To'
    TB_SHIPFROM = 'Ship From'
    TB_LOADING = 'Port of Loading'
    TB_DISCHARGE = 'Port of Discharge'
    TB_VESSEL = 'Vessel Name'
    TB_SHIPPER = 'Ship Per'
    TB_QUANTITY = 'Quantity'
    TB_SELLPRICE = 'Sell. Price'
    TB_BUYPRICE = 'Buy. Price'
    TB_COST = 'Cost'
    TB_RATIO = 'Ratio'
    TB_HSCODE = 'HS Code'
    TB_QUOTACAT = 'Quota Cat.'
    TB_GROUP1 = 'Group'
    TB_GROUP2 = 'Group 1'
    TB_GROUP3 = 'Group 2'
    TB_QTYPC = 'Qty/Unit'
    TB_PLANQTY = 'Planning Qty'
    TB_ACTUALQTY = 'Actual Qty'
    TB_PURCHASEQTY = 'Buy. Qty'
    TB_COLORCODE = 'Code'
    TB_COLOR = 'Color'
    TB_SIZE = 'Size'
    TB_POSITION = 'Position'
    TB_WASTEPCENT = 'Wastage(%)'
    TB_WASTEQTY = 'Wastage Qty'
    TB_UNITPRICE = 'Unit Price'
    TB_UNIT = 'Unit'
    TB_CCY = 'Ccy'
    TB_RATE = 'Exch. Rate'
    TB_REMARKS = 'Remarks'
    TB_SEQUENCE = 'Sequence #'
    TB_ORDERBY = 'Ordered by'
    TB_TOTAL = 'Total Amount'
    TB_SUBTOTAL = 'Sub-Total Amount'
    TB_TOTALQTY = 'Total'
    TB_SUBTOTALQTY = 'Sub-Total'
    TB_ORDERNO = 'Cust. P/O'
    TB_SOID = 'PI No.'
    TB_POID = 'PO No.'
    TB_INVID = 'Inv. No.'
    TB_JOID = 'JO No.'
    TB_QUOTID = 'Quot. No.'
    TB_CDNID = 'CDN No.'
    TB_SDNID = 'GRN No.'
    TB_VOUCHID = 'Vouch. No.'
    TB_SODATE = 'PI Date'
    TB_PODATE = 'PO Date'
    TB_INVDATE = 'Inv. Date'
    TB_JODATE = 'JO Date'
    TB_QUOTDATE = 'Quot. Date'
    TB_VOUCHDATE = 'Vouch. Date'
    TB_CDNDATE = 'CDN Date'
    TB_SDNDATE = 'GRN Date'
    TB_DOCDATE = 'Date'
    TB_SHIPDATE = 'Ship Date'
    TB_EXDATE = 'Ex. Fty. Date'
    TB_PRODDATE = 'Production Date'
    TB_INSPDATE = 'Insp. Date'
    TB_USERNAME = 'User Name'
    TB_CREATEBY = 'Created By'
    TB_MENU_ADD = 'Add Item'
    TB_MENU_DELETE = 'Remove Item'
    TB_MENU_INSERT = 'Insert Item'
    TB_MENU_ORDERING = 'Item Reordering'
    TB_MENU_DUPLICATE = 'Duplicate Current Item'
    TB_MENU_SAMEBOM = 'Same Style use'
    TB_MENU_HISTORY = 'Price History'
    TB_MENU_EXCHANGE = 'Exchange Rate Difference'
    IF EMPTY(SET_MYFILES)
       SET_MYFILES = SET_FILES
    ENDIF 
    = PAULTOOLBARDISP(DEF_LANG)
    TRADE_MARK = .F.
    PUBLIC OAPP
    OAPP = CREATEOBJECT('TasTrade')
    IF TYPE('oApp') = 'O'
       ON ERROR return
        OAPP.DO()
       RELEASE GCOLDDIR , GCOLDPATH , GCOLDCLASSLIB , GCOLDTALK , GCOLDESCAPE
    ENDIF 
 ENDIF 
 CLEAR DLLS
 CLEAR ALL
 RELEASE ALL EXTENDED 

PROCEDURE SetPath
 LOCAL LCSYS16 , LCPROGRAM
 LCSYS16 = SYS(16)
 LCPROGRAM = SUBSTR(LCSYS16,AT(':',LCSYS16) - 1)
 CD LEFT(LCPROGRAM,RAT('\',LCPROGRAM))
 IF RIGHT(LCPROGRAM,3) = 'FXP'
    CD ..
 ENDIF 
 SET PATH TO LIBS,FORMS,MENUS,PROGS,INCLUDE,DATA
 SET CLASSLIB TO MAIN , TSBASE , TSGEN , ABOUT
ENDPROC
*------
PROCEDURE paulTOOLBARDISP
 LPARAMETER PLLANGUAGE
 LOCAL PLLANGUAGE
 IF EMPTY(PLLANGUAGE)
    PLLANGUAGE = 'ENG'
 ENDIF 
 IF  .NOT. USED('toolbar')
    USE IN 0 toolbar
 ENDIF 
 SELECT TOOLBAR
 LOCATE FOR DEF_LANG = PLLANGUAGE
 IF FILE('ITOOLBAR.DBF')
    IF  .NOT. USED('itoolbar')
       USE IN 0 itoolbar
    ENDIF 
    SELECT ITOOLBAR
    IF ITOOLBAR.TB_FIRST
       TB_FIRST = ALLTRIM(TOOLBAR.TB_FIRST)
    ENDIF 
    IF ITOOLBAR.TB_LAST
       TB_LAST = ALLTRIM(TOOLBAR.TB_LAST)
    ENDIF 
    IF ITOOLBAR.TB_NEW
       TB_NEW = ALLTRIM(TOOLBAR.TB_NEW)
    ENDIF 
    IF ITOOLBAR.TB_SAVE
       TB_SAVE = ALLTRIM(TOOLBAR.TB_SAVE)
    ENDIF 
    TB_EDIT = ALLTRIM(TOOLBAR.TB_EDIT)
    TB_CANCEL = ALLTRIM(TOOLBAR.TB_CANCEL)
    TB_FOLLOWUP = ALLTRIM(TOOLBAR.TB_FOLLOWUP)
    IF TYPE('itoolbar.tb_edit') <> 'U'
       IF ITOOLBAR.TB_EDIT
          TB_EDIT = ALLTRIM(TOOLBAR.TB_EDIT)
       ENDIF 
       IF ITOOLBAR.TB_CANCEL
          TB_CANCEL = ALLTRIM(TOOLBAR.TB_CANCEL)
       ENDIF 
       IF ITOOLBAR.TB_FOLLOW
          TB_FOLLOWUP = ALLTRIM(TOOLBAR.TB_FOLLOWUP)
       ENDIF 
    ENDIF 
    IF ITOOLBAR.TB_DEL
       TB_DEL = ALLTRIM(TOOLBAR.TB_DEL)
    ENDIF 
    IF ITOOLBAR.TB_DUP
       TB_DUP = ALLTRIM(TOOLBAR.TB_DUP)
    ENDIF 
    IF ITOOLBAR.TB_QRY
       TB_QRY = ALLTRIM(TOOLBAR.TB_QRY)
    ENDIF 
    IF ITOOLBAR.TB_FLT
       TB_FLT = ALLTRIM(TOOLBAR.TB_FLT)
    ENDIF 
    IF ITOOLBAR.TB_RECALL
       TB_RECALL = ALLTRIM(TOOLBAR.TB_RECALL)
    ENDIF 
    IF ITOOLBAR.TB_PRN
       TB_PRN = ALLTRIM(TOOLBAR.TB_PRN)
    ENDIF 
    IF ITOOLBAR.TB_COPY
       TB_COPY = ALLTRIM(TOOLBAR.TB_COPY)
    ENDIF 
    IF ITOOLBAR.TB_PAST
       TB_PAST = ALLTRIM(TOOLBAR.TB_PAST)
    ENDIF 
    IF ITOOLBAR.TB_CUT
       TB_CUT = ALLTRIM(TOOLBAR.TB_CUT)
    ENDIF 
    IF ITOOLBAR.TB_RESTORE
       TB_RESTORE = ALLTRIM(TOOLBAR.TB_RESTORE)
    ENDIF 
    IF ITOOLBAR.TB_CAL
       TB_CAL = ALLTRIM(TOOLBAR.TB_CAL)
    ENDIF 
    IF ITOOLBAR.TB_DIRARY
       TB_DIRARY = ALLTRIM(TOOLBAR.TB_DIRARY)
    ENDIF 
    USE IN ITOOLBAR
 ELSE 
    TB_FIRST = ALLTRIM(TOOLBAR.TB_FIRST)
    TB_LAST = ALLTRIM(TOOLBAR.TB_LAST)
    TB_NEW = ALLTRIM(TOOLBAR.TB_NEW)
    TB_SAVE = ALLTRIM(TOOLBAR.TB_SAVE)
    IF TYPE('toolbar.tb_edit') <> 'U'
       TB_EDIT = ALLTRIM(TOOLBAR.TB_EDIT)
       TB_CANCEL = ALLTRIM(TOOLBAR.TB_CANCEL)
       TB_FOLLOWUP = ALLTRIM(TOOLBAR.TB_FOLLOWUP)
    ENDIF 
    TB_DEL = ALLTRIM(TOOLBAR.TB_DEL)
    TB_DUP = ALLTRIM(TOOLBAR.TB_DUP)
    TB_QRY = ALLTRIM(TOOLBAR.TB_QRY)
    TB_FLT = ALLTRIM(TOOLBAR.TB_FLT)
    TB_RECALL = ALLTRIM(TOOLBAR.TB_RECALL)
    TB_PRN = ALLTRIM(TOOLBAR.TB_PRN)
    TB_COPY = ALLTRIM(TOOLBAR.TB_COPY)
    TB_PAST = ALLTRIM(TOOLBAR.TB_PAST)
    TB_CUT = ALLTRIM(TOOLBAR.TB_CUT)
    TB_RESTORE = ALLTRIM(TOOLBAR.TB_RESTORE)
    TB_CAL = ALLTRIM(TOOLBAR.TB_CAL)
    TB_DIRARY = ALLTRIM(TOOLBAR.TB_DIRARY)
 ENDIF 
 IF VARTYPE(TB_EXPORT) = 'C'
    TB_EXPORT = ALLTRIM(TOOLBAR.TB_EXPORT)
 ENDIF 
 TB_PRIOR = ALLTRIM(TOOLBAR.TB_PRIOR)
 TB_NEXT = ALLTRIM(TOOLBAR.TB_NEXT)
 TB_CLOSE = ALLTRIM(TOOLBAR.TB_CLOSE)
 TB_MAINSCR = ALLTRIM(TOOLBAR.MAINSCR)
 TB_MENU = ALLTRIM(TOOLBAR.MAINMENU)
 IF SYS_WEBACCESS = 'Y'
    IF FILE('Mainweb.scx')
       TB_MAINSCR = 'mainweb'
    ENDIF 
    IF FILE('Mainweb.mpr')
       TB_MENU = 'Mainweb.mpr'
    ENDIF 
 ENDIF 
 USE IN TOOLBAR
 IF  .NOT. USED('caption')
    USE IN 0 caption AGAIN 
 ENDIF 
 SELECT CAPTION
 LOCATE FOR SCREEN_ID = 'ITEMS' AND LANGUAGE = PLLANGUAGE
 TB_SUB_ITEM = ALLTRIM(CAPTION.ITEMGRSTTL)
 TB_BAR_CODE = ALLTRIM(CAPTION.AGENT_NA)
 TB_LOOKUPID = ALLTRIM(CAPTION.BUYPRICE1)
 TB_ITEM_ID = ALLTRIM(CAPTION.ID1)
 TB_ITEM_NAME = ALLTRIM(CAPTION.PRODUCT_NAME)
 TB_DESC = ALLTRIM(CAPTION.DESC)
 LOCATE FOR SCREEN_ID = 'STOCK' AND LANGUAGE = PLLANGUAGE
 TB_STOCK_ID = ALLTRIM(CAPTION.ID1)
 USE IN CAPTION
 RETURN .T.
ENDPROC
*------*
